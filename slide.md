# 1. プレゼンの流れ

- 金融機関における機械学習の利用が進展
  - 信用リスク管理では、機械学習を応用したクレジットモデルなどが導入されている
- 機械学習モデルは、従来広く用いられているパラメトリックなモデルより予測精度が高い
  - 特に、説明変数と非説明変数の間に非線形性があったり、説明変数間の相互作用がある場合には優位
- もっとも、機械学習モデルは説明可能性が低いという課題も
  - 非線形性を捕捉するための複雑なモデル構造が仇になりやすい
  - 経営陣や監督当局に対してモデルの合理性を説明するときの障害となりうる
- ただ、近年は「説明可能な AI（eXplainable AI）」の発展により、機械学習モデルの説明可能性が向上している
- 今回の分析では、企業の財務指標から格付けを予測する機械学習モデルを構築し、企業の財務指標と信用力の関係性を定量的に解釈した
  - 売上高や ICR の説明力が高い
  - ICR が信用力に与える影響において、非線形性が存在

# 2. スライドの構成

## 2.1. プロジェクトの概要

- 金融機関では機械学習の利用が進んでいるが、説明可能性の低さが課題として挙げられることが多い。
- 信用リスク管理の分野での利用を想定して、企業の財務指標を特徴量、外部格付けをターゲットとする機械学習モデルを構築。予測精度を確認しつつ、財務指標が格付けの決定にどのように影響を及ぼしているかを定量的に把握する。
  - モデルは LightGBM（勾配ブースティングツリー）を利用

## 2.2. 金融機関における機械学習の利用

- BOE の調査などを引用しつつ、以下の 2 点に言及
  - 機械学習の利用が増加している
  - 課題として、説明可能性の低さ（合理性・妥当性の検証の困難さ）が挙げられることが多い

## 2.3. 予測精度と説明可能性のトレードオフ

- AAAI の資料をもとに、予測精度 vs 説明可能性のプロットを作成
  - 機械学習は、従来のパラメトリックなモデルと比較して、説明可能性が低い
  - もっとも、近年は XAI の研究が著しく進展し、説明可能性の低さを補うことが可能となってきている

## 2.4. なぜ機械学習は非線形性を捕捉できるのか

- 左にパラメトリック（順序ロジットの数式）、右に機械学習（ツリー）のポンチ絵
  - パラメトリックモデルは解釈が容易 but 並行性の仮定など関数形の制約
  - 機械学習は非線形性を捕捉しやすい but 解釈が難しい

## 2.5. 分析に用いた機械学習モデル（LightGBM）

- LightGBM（勾配ブースティングツリーの簡単な説明）
  - 情報共有セミナーで作成したスライドを引用する

## 2.6. データからみる企業の財務指標と格付けの関係１

- シンプルな線形な関係ではなく、単調・非単調の非線形性やばらつきの依存が存在
  - 図表 3 ～ 5 から、それぞれ ICR、流動比率、純利益成長率を並べる

## 2.7. データからみる企業の財務指標と格付けの関係２

- 特徴量間の相互依存関係が目的変数に影響する場合も
  - 22/10 月 FSR、図表 IV-2-5「企業財務と格付の関係」を使う

## 2.8. 機械学習モデルの予測精度

- こうしたケースでは、非線形性を捕捉しやすい機械学習の方がパラメトリックよりも高い予測精度を得られる
  - 図表 10 の AUC を掲載し、順序ロジット・機械学習の予測精度を比較

## 2.9. 機械学習の説明可能性を高める手法（XAI）

- 今回は SHAP と PDP を利用する
  - 図表 11 を掲載

## 2.10. SHAP によるサンプルレベルの評価

- SHAP は、サンプルごとに、予測値を特徴量の寄与度で加法的に分解する
  - 数式
- 利用例を見せる
  - 図表 12、13

## 2.11. SHAP によるマクロレベルの評価

- 特徴量が平均的に与える影響をみるには、SHAP dep plot がよい
  - 図表 15、売上高と ICR を掲載

## 2.12. PDP（2 変数）の PDP でみる特徴量間の依存関係

- 特徴量間の依存関係を見る場合には、PDP が有用
  - 図表 16

## 2.13. XAI の Caveats

- XAI も万能な指標ではなく、利用にあたってはその仮定や限界を正しく把握する必要
  - PDP は 1 つまたは 2 つの特徴量の値を機械的に変えている → その妥当性は考慮していない
  - SHAP は目的変数（クラス）の数だけ算出されるため、多クラス問題の場合、解釈が難しい可能性

## 2.14. まとめ

- 「予測精度は高いが説明可能性が低い」機械学習モデルは、XAI を活用することで、モデルの予測の決定要因をミクロ・マクロ的に分析したり、その合理性・妥当性を検証可能
  - 今回の分析を通じて、企業の格付けには、売上高や ICR などが強く影響していることを確認
- 金融機関の業務で機械学習の活用が進むもとで、XAI の重要性や有用性は今後も高まっていくと考えられる
